<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Earo Wang   slides on http://bit.ly/etc2420-lab04" />
  <title>ETC2420/5242   Statistical distribution in R</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <link rel="stylesheet" type="text/css" media="screen, projection, print"
    href="http://www.w3.org/Talks/Tools/Slidy2/styles/slidy.css" />
  <link rel="stylesheet" type="text/css" media="screen, projection, print"
   href="../myslidy.css" />
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
  <script src="http://www.w3.org/Talks/Tools/Slidy2/scripts/slidy.js"
    charset="utf-8" type="text/javascript"></script>
</head>
<body>
<div class="slide titlepage">
  <h1 class="title">ETC2420/5242 <br> Statistical distribution in R</h1>
  <p class="author">
Earo Wang <br> slides on <a href="http://bit.ly/etc2420-lab04" class="uri">http://bit.ly/etc2420-lab04</a>
  </p>
  <p class="date">Lab 04</p>
</div>
<div id="statistical-distributions" class="slide section level1">
<h1>Statistical distributions</h1>
<!-- <center><img src="figure/pnorm.png" alt="normal" style="width: 1400px; height: 490px"/></center> -->
<h2 id="compute-the-probabilities-for-n2-0.5">Compute the probabilities for <span class="math inline">\(N(2, 0.5)\)</span></h2>
<p><img src="figure/ex-plot-1.png" title="plot of chunk ex-plot" alt="plot of chunk ex-plot" style="display: block; margin: auto;" /></p>
<ul>
<li><span class="math inline">\(\Pr(X &lt; 1.3)\)</span></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pnorm</span>(<span class="fl">1.3</span>, <span class="dt">mean =</span> <span class="dv">2</span>, <span class="dt">sd =</span> <span class="fl">0.5</span>)</code></pre></div>
<pre><code>## [1] 0.08075666</code></pre>
<ul>
<li><span class="math inline">\(\Pr(X &gt; 1.9) = 1 - \Pr(X \le 1.9)\)</span></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pnorm</span>(<span class="fl">1.9</span>, <span class="dt">mean =</span> <span class="dv">2</span>, <span class="dt">sd =</span> <span class="fl">0.5</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## [1] 0.5792597</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span> -<span class="st"> </span><span class="kw">pnorm</span>(<span class="fl">1.9</span>, <span class="dt">mean =</span> <span class="dv">2</span>, <span class="dt">sd =</span> <span class="fl">0.5</span>)</code></pre></div>
<pre><code>## [1] 0.5792597</code></pre>
<ul>
<li><span class="math inline">\(\Pr(1.8 &lt; X &lt; 2.2) = \Pr(X &lt; 2.2) - \Pr(X &lt; 1.8)\)</span></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pnorm</span>(<span class="fl">2.2</span>, <span class="dt">mean =</span> <span class="dv">2</span>, <span class="dt">sd =</span> <span class="fl">0.5</span>) -<span class="st"> </span><span class="kw">pnorm</span>(<span class="fl">1.8</span>, <span class="dt">mean =</span> <span class="dv">2</span>, <span class="dt">sd =</span> <span class="fl">0.5</span>)</code></pre></div>
<pre><code>## [1] 0.3108435</code></pre>
<h2 id="compute-the-quantile-values-for-n-3-4">Compute the quantile values for <span class="math inline">\(N(-3, 4)\)</span></h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qnorm</span>(<span class="kw">c</span>(<span class="fl">0.53</span>, <span class="fl">0.12</span>, <span class="fl">0.84</span>, <span class="fl">1.2</span>), <span class="dt">mean =</span> -<span class="dv">3</span>, <span class="dt">sd =</span> <span class="dv">4</span>)</code></pre></div>
<pre><code>## [1] -2.6989206 -7.6999472  0.9778315        NaN</code></pre>
<h2 id="compute-the-densities-for-n-1.2-0.8">Compute the densities for <span class="math inline">\(N(-1.2, 0.8)\)</span></h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dnorm</span>(<span class="kw">c</span>(-<span class="dv">1</span>, -<span class="fl">0.2</span>, -<span class="dv">2</span>), <span class="dt">mean =</span> -<span class="fl">1.2</span>, <span class="dt">sd =</span> <span class="fl">0.8</span>)</code></pre></div>
<pre><code>## [1] 0.4833351 0.2283114 0.3024634</code></pre>
<h2 id="plot-the-density-curves-for-weibull">Plot the density curves for Weibull</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xgrid &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">7</span>, <span class="fl">0.01</span>)
df_weibull &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> xgrid,
                         <span class="dt">y1 =</span> <span class="kw">dweibull</span>(xgrid, <span class="dt">shape =</span> <span class="dv">2</span>, <span class="dt">scale =</span> <span class="fl">2.5</span>),
                         <span class="dt">y2 =</span> <span class="kw">dweibull</span>(xgrid, <span class="dt">shape =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">2.5</span>),
                         <span class="dt">y3 =</span> <span class="kw">dweibull</span>(xgrid, <span class="dt">shape =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="dv">1</span>))
<span class="kw">library</span>(ggplot2)
df_weibull %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> xgrid)) +
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> y1), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>) +
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> y2), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>) +
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> y3), <span class="dt">col =</span> <span class="st">&quot;orange&quot;</span>) +
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;x&quot;</span>) +
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;densities&quot;</span>)</code></pre></div>
<p><img src="figure/ex-weibull-1.png" title="plot of chunk ex-weibull" alt="plot of chunk ex-weibull" style="display: block; margin: auto;" /></p>
</div>
<div id="qq-plot" class="slide section level1">
<h1>QQ-plot</h1>
<h2 id="simulate-sample-of-size-n-500-from-gamma2-4">Simulate sample of size <span class="math inline">\(n = 500\)</span> from <span class="math inline">\(\Gamma(2, 4)\)</span></h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">123</span>)
n &lt;-<span class="st"> </span><span class="dv">500</span>
alpha &lt;-<span class="st"> </span><span class="dv">2</span>
beta &lt;-<span class="st"> </span><span class="dv">4</span>
df_gamma &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">xgamma =</span> <span class="kw">rgamma</span>(n, <span class="dt">shape =</span> alpha, <span class="dt">rate =</span> beta))</code></pre></div>
<h2 id="qq-plot-computation">QQ-Plot computation</h2>
<ol style="list-style-type: decimal">
<li>Sort and standardise the sample values from low to high</li>
<li>Theoretical quantiles, <span class="math inline">\(n=\)</span> sample size <span class="math display">\[  1 - 0.5^{(1/n)} ~~~ i=1 \\
   ~~~~~~~~~~~~~\frac{i - 0.3175}{n + 0.365} ~~~ i=2, ..., n-1 \\
   0.5^{(1/n)} ~~~~~~ ~~~  i=n \]</span></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_gamma$xq &lt;-<span class="st"> </span><span class="kw">qgamma</span>(<span class="kw">c</span>(<span class="dv">1</span> -<span class="st"> </span><span class="fl">0.5</span>^(<span class="dv">1</span>/n), <span class="co"># i = 1</span>
                        (<span class="dv">2</span>:(n<span class="dv">-1</span>) -<span class="st"> </span><span class="fl">0.3175</span>) /<span class="st"> </span>(n +<span class="st"> </span><span class="fl">0.365</span>), <span class="co"># i = 2, ... , n - 1</span>
                        <span class="fl">0.5</span>^(<span class="dv">1</span>/n)), <span class="co"># i = n</span>
                      alpha, beta) <span class="co"># theoretical quantiles</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Plot the theoretical vs sample quantiles</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_gamma %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">sort</span>(xgamma), <span class="dt">y =</span> xq)) +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">slope =</span> <span class="dv">1</span>) +<span class="st"> </span><span class="co"># X = Y line</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Sample quantiles&quot;</span>) +
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Theoretical quantiles&quot;</span>) +
<span class="st">  </span><span class="kw">coord_equal</span>()</code></pre></div>
<p><img src="figure/q1-c-1.png" title="plot of chunk q1-c" alt="plot of chunk q1-c" style="display: block; margin: auto;" /></p>
</div>
<div id="likelihood-function" class="slide section level1">
<h1>Likelihood function</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">123</span>)
X2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">rgamma</span>(<span class="dt">n =</span> <span class="dv">267</span>, <span class="fl">1.2</span>, <span class="fl">0.25</span>))</code></pre></div>
<h2 id="histogram-for-the-sample">Histogram for the sample</h2>
<p><img src="figure/q2-hist-1.png" title="plot of chunk q2-hist" alt="plot of chunk q2-hist" style="display: block; margin: auto;" /></p>
<h2 id="compute-the-likelihood-function">Compute the likelihood function</h2>
<p><span class="math display">\[
\begin{aligned}
L(\alpha, \beta) &amp;=\Pr(X_1=x_1,X_2=x_2, ... ,X_n=x_n~\big\vert~\alpha, \beta) \\      
&amp;=f(x_1\big\vert\alpha, \beta)f(x_2\big\vert\alpha, \beta)\cdots f(x_n\big\vert\alpha, \beta) \\
&amp;=\prod_{i=1}^n f(x_i;\alpha, \beta)
\end{aligned}
\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nmle &lt;-<span class="st"> </span>function(x, alpha, beta) {
  <span class="co"># L(alpha, beta) = product of joint density functions</span>
}</code></pre></div>
<h2 id="plot-the-likelihood-function-for-a-range-of-values-of-alpha-and-beta">Plot the likelihood function for a range of values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span></h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">alpha &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.9</span>, <span class="fl">1.5</span>, <span class="fl">0.01</span>)
beta &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.18</span>, <span class="fl">0.32</span>, <span class="fl">0.005</span>)
g &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">x =</span> alpha, <span class="dt">y =</span> beta) <span class="co"># all possible combinations of alpha and beta</span>
g$l &lt;-<span class="st"> </span><span class="dv">0</span>
for (i in <span class="dv">1</span>:<span class="kw">nrow</span>(g)) {
  g$l[i] &lt;-<span class="st"> </span><span class="kw">nmle</span>(X2$x, g$x[i], g$y[i])
}</code></pre></div>
<p><img src="figure/q2-plot2-1.png" title="plot of chunk q2-plot2" alt="plot of chunk q2-plot2" style="display: block; margin: auto;" /></p>
<h2 id="interactive-3d-scatter-plot-using-plotly">Interactive 3D scatter plot using <code>plotly</code></h2>
<iframe src="3dscatter.html" height="100%" width="70%" align="middle">
</iframe>
<h2 id="find-the-mle-estimates-for-alpha-beta">Find the MLE estimates for <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span></h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MASS)
<span class="kw">fitdistr</span>(X2$x, <span class="st">&quot;gamma&quot;</span>)</code></pre></div>
<pre><code>##      shape         rate   
##   1.23994762   0.28051981 
##  (0.09624333) (0.02667898)</code></pre>
<p>p.s. if you have trouble in installing the <code>CASdatasets</code> package, the following code may solve the issue.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages(&quot;xts&quot;)</span>
<span class="co"># install.packages(&quot;sp&quot;)</span>
<span class="co"># install.packages(&quot;CASdatasets&quot;, repos = &quot;http://cas.uqam.ca/pub/R/&quot;)</span>
<span class="kw">library</span>(CASdatasets)
<span class="kw">data</span>(danishuni)</code></pre></div>
</div>
<div id="misc" class="slide section level1">
<h1>Misc</h1>
<h2 id="online-r-resources">Online R resources</h2>
<ul>
<li><a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/Distributions.html">A list of distribution functions in R</a></li>
<li><a href="http://tutorials.iq.harvard.edu/R/Rgraphics/Rgraphics.html">Introduction to R Graphics with ggplot2</a></li>
<li><a href="http://www.cookbook-r.com/Graphs/">Cookbook for R</a></li>
</ul>
<h2 id="consultation-hours">Consultation hours</h2>
<ul>
<li>Earo
<ul>
<li><strong>Time</strong>: 13:30 to 15:00 on Thursday</li>
<li><strong>Venue</strong>: Level 11/W1106, Menzies Building</li>
</ul></li>
<li>Nathaniel
<ul>
<li><strong>Time</strong>: 14:00 to 15:00 on Tuesday</li>
<li><strong>Venue</strong>: Level 11/W1106, Menzies Building</li>
</ul></li>
</ul>
<p><meta name="copyright" content="LICENSE: CC BY-NC 3.0 US" /></p>
</div>
</body>
</html>
