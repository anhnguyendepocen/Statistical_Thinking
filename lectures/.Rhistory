theme(aspect.ratio=1)
grid.arrange(p1, p2, ncol=2)
df1 <- data.frame(Total=df$Total+1,
q=qpareto(c(1 - 0.5^(1/n), (2:(n-1) - 0.3175) /
(n + 0.365),0.5^(1/n)),
0.94))
df2 <- data.frame(x=seq(1,104,1),
d=dpareto(seq(1,104,1),
0.94))
p1 <- ggplot(df1, aes(x=Total)) + geom_histogram(aes(y=..density..)) +
geom_line(data=df2, aes(x=x, y=d), colour="red") +
ylim(c(0,0.25))
p2 <- ggplot(df1, aes(x=Total, y=q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + xlim(c(0,105)) + ylim(c(0,105)) +
xlab("Sample") + ylab("Theoretical quantiles") +
theme(aspect.ratio=1)
grid.arrange(p1, p2, ncol=2)
df1 <- data.frame(Total=df$Total+1,
q=qpareto(c(1 - 0.5^(1/n), (2:(n-1) - 0.3175) /
(n + 0.365),0.5^(1/n)),
0.96))
df2 <- data.frame(x=seq(1,104,1),
d=dpareto(seq(1,104,1),
0.96))
p1 <- ggplot(df1, aes(x=Total)) + geom_histogram(aes(y=..density..)) +
geom_line(data=df2, aes(x=x, y=d), colour="red") +
ylim(c(0,0.25))
p2 <- ggplot(df1, aes(x=Total, y=q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + xlim(c(0,105)) + ylim(c(0,105)) +
xlab("Sample") + ylab("Theoretical quantiles") +
theme(aspect.ratio=1)
grid.arrange(p1, p2, ncol=2)
olympics2004 <- read_csv("../data/olympics2004.csv")
df <- data.frame(Total=c(rep(0, 127), sort(olympics2004$Total)))
n <- 201
df1 <- data.frame(Total=df$Total+1,
q=qpareto(c(1 - 0.5^(1/n), (2:(n-1) - 0.3175) /
(n + 0.365),0.5^(1/n)),
0.94))
df2 <- data.frame(x=seq(1,104,1),
d=dpareto(seq(1,104,1),
0.94))
p1 <- ggplot(df1, aes(x=Total)) + geom_histogram(aes(y=..density..)) +
geom_line(data=df2, aes(x=x, y=d), colour="red") +
ylim(c(0,0.25))
p2 <- ggplot(df1, aes(x=Total, y=q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + xlim(c(0,105)) + ylim(c(0,105)) +
xlab("Sample") + ylab("Theoretical quantiles") +
theme(aspect.ratio=1)
grid.arrange(p1, p2, ncol=2)
df <- data.frame(Total=c(rep(0, 119), sort(olympics2012$Total)))
mean(df$Total)
median(df$Total)
glimpse(olympics2008)
glimpse(olympics2004)
?read_delim
gdp <- read_delim("../data/gdp2008.csv", delim="\t", col_names=FALSE)
head(gdp)
tail(gdp)
gdp2008 <- read_delim("../data/gdp2008.csv", delim="\t",
col_names=FALSE)[,3:4]
tail(gdp)
tail(gdp2008)
colnames(gdp2008) <- c("Country", "GDP")
tail(gdp2008)
oly_gdp <- merge(olympics2008, gdp2008, by="Country")
?merge
oly_gdp <- merge(olympics2008, gdp2008, by="Country", all.x=TRUE)
oly_gdp
oly_gdp %>% filter(is.na(GDP)) %>% select(Country, GDP)
oly_gdp %>% filter(is.na(GDP))
gdp2008 <- read_delim("../data/gdp2008.csv", delim="\t",
col_names=FALSE)[,3:4]
colnames(gdp2008) <- c("Country", "GDP")
oly_gdp <- merge(olympics2008, gdp2008, by="Country", all.x=TRUE)
oly_gdp %>% filter(is.na(GDP))
gdp2012 <- read_delim("../data/gdp2012.csv", delim="\t",
col_names=FALSE)[,1:2]
head(gdp2012)
colnames(gdp2012) <- c("Country", "GDP")
oly_gdp2012 <- merge(olympics2012, gdp2012, by="Country", all.x=TRUE)
oly_gdp2012 %>% filter(is.na(GDP))
gdp2012 <- read_delim("../data/gdp2012.csv", delim="\t",
col_names=FALSE)[,1:2]
colnames(gdp2012) <- c("Country", "GDP")
oly_gdp2012 <- merge(olympics2012, gdp2012, by="Country", all.x=TRUE)
oly_gdp2012 %>% filter(is.na(GDP))
oly_gdp2012 <- merge(oly_gdp2012, olympics2008, by="Country",
all.x=TRUE)
glimpse(oly_gdp2012)
glimpse(olympics2008)
oly_gdp2012 <- merge(olympics2012, gdp2012, by="Country", all.x=TRUE)
oly_gdp2012 <- merge(oly_gdp2012, olympics2008[,c("Country","Total")],
by="Country", all.x=TRUE)
glimpse(oly_gdp2012)
colnames(oly_gdp2012)[7] <- "Total"
colnames(oly_gdp2012)[13] <- "Total.2008"
glimpse(oly_gdp2012)
oly12_lm <- glm(Total~Total.2008+Population+GDP, data=oly_gdp2012)
oly12_lm
summary(oly12_lm)
kable(oly12_lm$coefficients)
oly12_lm$coefficients
str(summary(oly12_lm))
coefficients(oly12_lm)
coefficients(oly12_lm)[1:4]
coefficients(oly12_lm)[1:4, 1:14]
coefficients(oly12_lm)[1:4, 1:4]
str(summary(oly12_lm)$coefficients)
summary(oly12_lm)$coefficients
summary(oly_gdp2012$Total)
summary(oly12_lm)
oly_gdp2012$fit <- fitted(oly12_lm)
str(oly12_lm)
oly_gdp2012$fit <- oly12_lm$fitted.values
summary(oly_gdp2012)
oly_gdp2012 %>% filter(is.na(Population))
oly_gdp2012[Country=="HongKongChina", "Population"] <- 7155000
oly_gdp2012[oly_gdp2012$Country=="HongKongChina", "Population"] <- 7155000
oly_gdp2012[is.na(oly_gdp2012$Total.2008), "Total.2008"] <- 0
oly12_lm <- glm(Total~Total.2008+Population+GDP, data=oly_gdp2012)
kable(summary(oly12_lm)$coefficients)
oly12_lm)$coefficients
summary(oly12_lm)$coefficients
summary(oly12_lm)
oly_gdp2012$fit <- oly12_lm$fitted.values
oly_gdp2012$res <- oly12_lm$residuals
p1 <- ggplot(oly_gdp2012, aes(x=fit, y=Total)) + geom_point() +
theme(aspect.ratio=1)
p2 <- ggplot(oly_gdp2012, aes(x=fit, y=res)) + geom_point() +
theme(aspect.ratio=1)
grid.arrange(p1, p2, ncol=2)
ggplotly
library(plotly)
?ggplotly
x <- runif(100)
df <- data.frame(x=x, y=-3*x+5+rnorm(100))
ggplot(df, aes(x=x, y=y)) + geom_point() +
geom_smooth(method="lm") + xlab("X") + ylab("Y")
ggplot(df, aes(x=x, y=y)) + geom_point() +
geom_smooth(method="lm", se=F) + xlab("X") + ylab("Y") +
geom_text(aes(x=0.75, y=7,
label=expression(beta_0+beta_1X)), colour="blue")
ggplot(df, aes(x=x, y=y)) + geom_point() +
geom_smooth(method="lm", se=F) + xlab("X") + ylab("Y") +
geom_text(aes(x=0.75, y=7,
label="b0+b1X"), colour="blue")
library(xkcd)
?xkcd
str(oly12_lm)
library(broom)
help(package="broom")
tidy(oly12_lm)
glance(oly12_lm)
head(augment(oly12_lm))
head(oly_gdp2012)
?glm
glimpse(oly_gdp2012_diag)
oly_gdp2012_diag <- augment(oly12_lm)
glimpse(oly_gdp2012_diag)
?augment
olympics2008 <- read_csv("../data/olympics2008.csv")
olympics2012 <- read_csv("../data/olympics2012.csv")
gdp2008 <- read_delim("../data/gdp2008.csv", delim="\t",
col_names=FALSE)[,3:4]
colnames(gdp2008) <- c("Country", "GDP")
oly_gdp2008 <- merge(olympics2008, gdp2008, by="Country", all.x=TRUE)
gdp2012 <- read_delim("../data/gdp2012.csv", delim="\t",
col_names=FALSE)[,1:2]
colnames(gdp2012) <- c("Country", "GDP")
oly_gdp2012 <- merge(olympics2012, gdp2012, by="Country", all.x=TRUE)
oly_gdp2012 <- merge(oly_gdp2012, olympics2008[,c("Country","Total")],
by="Country", all.x=TRUE)
colnames(oly_gdp2012)[7] <- "Total"
colnames(oly_gdp2012)[13] <- "Total.2008"
oly_gdp2012[oly_gdp2012$Country=="HongKongChina", "Population"] <- 7155000
oly_gdp2012[is.na(oly_gdp2012$Total.2008), "Total.2008"] <- 0
library(readr)
olympics2008 <- read_csv("../data/olympics2008.csv")
olympics2012 <- read_csv("../data/olympics2012.csv")
gdp2008 <- read_delim("../data/gdp2008.csv", delim="\t",
col_names=FALSE)[,3:4]
colnames(gdp2008) <- c("Country", "GDP")
oly_gdp2008 <- merge(olympics2008, gdp2008, by="Country", all.x=TRUE)
gdp2012 <- read_delim("../data/gdp2012.csv", delim="\t",
col_names=FALSE)[,1:2]
colnames(gdp2012) <- c("Country", "GDP")
oly_gdp2012 <- merge(olympics2012, gdp2012, by="Country", all.x=TRUE)
oly_gdp2012 <- merge(oly_gdp2012, olympics2008[,c("Country","Total")],
by="Country", all.x=TRUE)
colnames(oly_gdp2012)[7] <- "Total"
colnames(oly_gdp2012)[13] <- "Total.2008"
oly_gdp2012[oly_gdp2012$Country=="HongKongChina", "Population"] <- 7155000
oly_gdp2012[is.na(oly_gdp2012$Total.2008), "Total.2008"] <- 0
summary(oly_gdp2012$Population)
summary(oly_gdp2012$GDP)
library(readr)
olympics2008 <- read_csv("../data/olympics2008.csv")
olympics2012 <- read_csv("../data/olympics2012.csv")
ol <- merge(olympics2012, olympics2008[,c("Country","Total")],
by="Country", all.x=TRUE)
glimpse(ol)
library(dplyr)
glimpse(ol)
colnames(ol)["Total.x" <- "M2012"
colnames(ol)["Total.y" <- "M2008"
colnames(ol)["Total.x"] <- "M2012"
colnames(ol)[7] <- "M2012"
colnames(ol)[12] <- "M2008"
ol_lm <- lm(M2012~M2008, data=ol)
ol_lm
ol
ol[,c(1,7,12)]
0.74+0.96*12
0.74+0.96*2
olympics2008 <- read_csv("../data/olympics2008.csv")
olympics2012 <- read_csv("../data/olympics2012.csv")
oly <- merge(olympics2012[,c("Country","Total")],
olympics2008[,c("Country","Total")], by="Country",
all.x=TRUE)
head(oly)
colnames(oly)[2] <- "M2012"
colnames(oly)[3] <- "M2008"
oly_lm <- glm(M2012~M2008, data=oly)
library(broom)
kable(tidy(oly12_lm))
tidy(oly12_lm)
library(tidyr)
tidy(oly_lm)
pareto.mle <- function(x)
{
xm <- min(x)
alpha <- length(x)/(sum(log(x))-length(x)*log(xm))
return( list(xm = xm, alpha = alpha))
}
library(readr)
library(ggplot2)
olympics2012 <- read_csv("../data/olympics2012.csv")
df <- data.frame(Total=c(rep(0, 119), sort(olympics2012$Total)))
pareto.mle(df$Total)
pareto.mle(df$Total+1)
coefs <- tidy(oly_lm)
coefs
coefs$estimate
summary(olympics2008)
?glance
oly$Country
oly_noUSA <- oly %>% filter(Country != "UnitedStates")
oly_noUSA_lm <- glm(M2012~M2008, data=oly_noUSA)
coefs_noUSA <- tidy(oly_noUSA_lm)
coefs_noUSA
coefs
library(knitr)
?kable
comp_estimates_m <- gather(comp_estimates)
comp_estimates <- data.frame(all=coefs$estimate,
noUSA=coefs_noUSA$estimate)
rownames(comp_estimates) <- c("intercept", "Slope")
comp_estimates_m <- gather(comp_estimates)
comp_estimates_m
comp_estimates
comp_estimates <- data.frame(all=coefs$estimate,
noUSA=coefs_noUSA$estimate)
comp_estimates$estimate <- c("intercept", "slope")
comp_estimates_m <- gather(comp_estimates)
comp_estimates_m
comp_estimates_m <- gather(comp_estimates, -estimate)
comp_estimates_m <- gather(comp_estimates, model, stat, -estimate)
comp_estimates_m <- gather(comp_estimates, -estimate)
comp_estimates_m
comp_estimates_m <- comp_estimates %>%
gather(model, stat, -estimate) %>%
spread(estimate, stat)
comp_estimates_m
ggplot(oly, aes(x=M2008, y=M2012)) + geom_point() +
geom_abline(comp_estimates_m,
aes(intercept=intercept, slope=slope, colour=model))
?geom_abline
ggplot(oly, aes(x=M2008, y=M2012)) + geom_point() +
geom_abline(comp_estimates_m,
aes(xintercept=intercept, slope=slope, colour=model))
ggplot(mtcars, aes(mpg, wt, colour = wt)) +
geom_point() +
geom_hline(aes(yintercept = wt, colour = wt), mean_wt) +
facet_wrap(~ cyl)
ggplot(oly, aes(x=M2008, y=M2012)) + geom_point() +
geom_abline(comp_estimates_m,
aes(xintercept=intercept, slope=slope, colour=model))
mean_wt <- data.frame(cyl = c(4, 6, 8), wt = c(2.28, 3.11, 4.00))
ggplot(mtcars, aes(mpg, wt, colour = wt)) +
geom_point() +
geom_hline(aes(yintercept = wt, colour = wt), mean_wt) +
facet_wrap(~ cyl)
ggplot(oly, aes(x=M2008, y=M2012)) + geom_point() +
geom_abline(data=comp_estimates_m,
aes(xintercept=intercept, slope=slope, colour=model))
comp_estimates_m
?geom_abline
ggplot(oly, aes(x=M2008, y=M2012)) + geom_point() +
geom_abline(data=comp_estimates_m,
aes(intercept=intercept, slope=slope, colour=model))
?augment
comp_diag <- data.frame(
null.dev=c(glance(oly_lm)$null.deviance, glance(oly_noUSA_lm)$null.deviance),
deviance=c(glance(oly_lm)$deviance, glance(oly_noUSA_lm)$deviance),
fitted=c(augment(oly_lm)$.fitted, augment(oly_noUSA_lm)$.fitted),
residc(augment(oly_lm)$.resid, augment(oly_noUSA_lm)$.resid))
comp_diag <- data.frame(
null.dev=c(glance(oly_lm)$null.deviance, glance(oly_noUSA_lm)$null.deviance),
deviance=c(glance(oly_lm)$deviance, glance(oly_noUSA_lm)$deviance),
fitted=c(augment(oly_lm)$.fitted, augment(oly_noUSA_lm)$.fitted),
resid=c(augment(oly_lm)$.resid, augment(oly_noUSA_lm)$.resid))
predict(oly_lm, oly[oly$Country=="UnitedStates",])
comp_diag <- data.frame(
null.dev=c(glance(oly_lm)$null.deviance, glance(oly_noUSA_lm)$null.deviance),
deviance=c(glance(oly_lm)$deviance, glance(oly_noUSA_lm)$deviance),
fitted=c(predict(oly_lm, oly[oly$Country=="UnitedStates",]),
predict(oly_noUSA_lm, oly[oly$Country=="UnitedStates",])),
resid=c(oly$M2012[oly$Country=="UnitedStates"]-
predict(oly_lm, oly[oly$Country=="UnitedStates",]),
oly$M2012[oly$Country=="UnitedStates"]-
predict(oly_noUSA_lm, oly[oly$Country=="UnitedStates",])))
comp_diag
df <- data.frame(x=c(runif(99), 100))
df$y <- x+c(rnorm(99), 6)
df_all <- glm(y~x, data=df)
df_no <- glm(y~x, data=df[-100,])
df <- data.frame(x=c(runif(99), 100))
df$y <- df$x+c(rnorm(99), 6)
df_all <- glm(y~x, data=df)
df_no <- glm(y~x, data=df[-100,])
ggplot(df, aes(x=x, y=y)) + geom_point() +
geom_smooth(method="lm", colour="red") +
geom_smooth(data=df[-100,], method="lm", colour="teal")
ggplot(df, aes(x=x, y=y)) + geom_point() +
geom_smooth(method="lm", colour="red") +
geom_smooth(data=df[-100,], method="lm", colour="blue")
df <- data.frame(x=c(runif(99), 10))
df$y <- df$x+c(rnorm(99), 6)
df_all <- glm(y~x, data=df)
df_no <- glm(y~x, data=df[-100,])
ggplot(df, aes(x=x, y=y)) + geom_point() +
geom_smooth(method="lm", colour="red", se=F) +
geom_smooth(data=df[-100,], method="lm", colour="blue", se=F)
?geom_smooth
ggplot(df, aes(x=x, y=y)) + geom_point() +
geom_smooth(method="lm", colour="red", se=F) +
geom_smooth(data=df[-100,], method="lm", colour="skyblue", se=F)
df_est <- data.frame(all=tidy(df_all)$estimate,
no=tidy(df_no)$estimate)
df_est$estimate <- c("intercept", "slope")
df_est_m <- df_est %>%
gather(model, stat, -estimate) %>%
spread(estimate, stat)
df_est_m
ggplot(df, aes(x=x, y=y)) + geom_point() +
geom_abline(data=df_est_m,
aes(intercept=intercept, slope=slope, colour=model))
oly_diag <- augment(oly_lm)
head(oly_diag)
source('~/.active-rstudio-document', echo=TRUE)
oly_diag <- augment(oly_lm)
glimpse(oly_diag)
oly_diag$Country <- oly$Country
oly <- merge(olympics2012[,c("Country","Total")],
olympics2008[,c("Country","Total")], by="Country",
all.x=TRUE)
colnames(oly)[2] <- "M2012"
colnames(oly)[3] <- "M2008"
oly_lm <- glm(M2012~M2008, data=oly)
oly_diag <- augment(oly_lm)
dim(oly_diag)
oly <- oly %>% filter(!is.na(M2008))
2/73
ggplot(oly_diag, aes(x=.hat)) + geom_histogram()
ggplot(oly_diag, aes(x=.hat)) + geom_histogram() +
geom_vline(xintercept=0.027, colour="red")
oly_tf$M2008 <- log10(oly_tf$M2008)
oly_tf <- oly
oly_tf$M2008 <- log10(oly_tf$M2008)
oly_tf$M2012 <- log10(oly_tf$M2012)
oly_tf_lm <- glm(M2012~M2008, data=oly_tf)
oly_tf_diag <- augment(oly_tf_lm)
oly_tf_diag$Country <- oly$Country
oly_tf_diag %>% arrange(desc(.hat)) %>% select(Country, .hat) %>% head(15)
ggplot(oly_tf, aes(x=M2008, y=M2012)) + geom_point()
ggplot(oly_tf, aes(x=M2008, y=M2012)) + geom_point() +
xlab("Log counts 2008") + ylab("Log counts 2012")
oly_tf <- oly
oly_tf$M2008 <- log10(oly_tf$M2008)
oly_tf$M2012 <- log10(oly_tf$M2012)
oly_tf_lm <- glm(M2012~M2008, data=oly_tf)
oly_tf_diag <- augment(oly_tf_lm)
oly_tf_diag$Country <- oly$Country
oly_tf_diag %>% arrange(desc(.hat)) %>% select(Country, .hat) %>% head(15)
ggplot(oly_tf_diag, aes(x=.hat)) + geom_histogram() +
geom_vline(xintercept=0.027, colour="red")
glimpse(oly_diag)
tbl1 <- oly_diag %>% arrange(desc(.hat)) %>% select(Country, .hat)
oly_diag$Country <- oly$Country
tbl1 <- oly_diag %>% arrange(desc(.hat)) %>% select(Country, .hat)
tbl2 <- oly_tf_diag %>% arrange(desc(.hat)) %>% select(Country, .hat)
tbl <- cbind(tbl1, tb2)
```
tbl <- cbind(tbl1, tbl2)
head(tbl)
tbl1 <- oly_diag %>% arrange(desc(.cooksd)) %>% select(Country, .cooksd)
tbl2 <- oly_tf_diag %>% arrange(desc(.cooksd)) %>% select(Country, .cooksd)
tbl <- cbind(tbl1, tbl2)
head(tbl)
4/73
vif(ol_lm)
library(car)
install.packages("car")
library(car)
help(package="car")
vif(ol_lm)
?install.packages
?install.package
olympics2008 <- read_csv("../data/olympics2008.csv")
olympics2012 <- read_csv("../data/olympics2012.csv")
gdp2008 <- read_delim("../data/gdp2008.csv", delim="\t",
col_names=FALSE)[,3:4]
colnames(gdp2008) <- c("Country", "GDP")
oly_gdp2008 <- merge(olympics2008, gdp2008, by="Country", all.x=TRUE)
gdp2012 <- read_delim("../data/gdp2012.csv", delim="\t",
col_names=FALSE)[,1:2]
colnames(gdp2012) <- c("Country", "GDP")
oly_gdp2012 <- merge(olympics2012, gdp2012, by="Country", all.x=TRUE)
oly_gdp2012 <- merge(oly_gdp2012, olympics2008[,c("Country","Total")],
by="Country", all.x=TRUE)
colnames(oly_gdp2012)[7] <- "Total"
colnames(oly_gdp2012)[13] <- "Total.2008"
oly_gdp2012[oly_gdp2012$Country=="HongKongChina", "Population"] <- 7155000
oly_gdp2012[is.na(oly_gdp2012$Total.2008), "Total.2008"] <- 0
oly_gdp2012 <- oly_gdp2012 %>%
mutate(Pop_std=scale(Population), GDP_std=scale(GDP))
oly12_lm <- glm(Total~Total.2008+Pop_std+GDP_std, data=oly_gdp2012)
oly12_lm_est <- tidy(oly12_lm)
oly12_lm_est
olympics2008 <- read_csv("../data/olympics2008.csv")
olympics2012 <- read_csv("../data/olympics2012.csv")
gdp2008 <- read_delim("../data/gdp2008.csv", delim="\t",
col_names=FALSE)[,3:4]
colnames(gdp2008) <- c("Country", "GDP")
oly_gdp2008 <- merge(olympics2008, gdp2008, by="Country", all.x=TRUE)
gdp2012 <- read_delim("../data/gdp2012.csv", delim="\t",
col_names=FALSE)[,1:2]
colnames(gdp2012) <- c("Country", "GDP")
oly_gdp2012 <- merge(olympics2012, gdp2012, by="Country", all.x=TRUE)
oly_gdp2012 <- merge(oly_gdp2012, olympics2008[,c("Country","Total")],
by="Country", all.x=TRUE)
colnames(oly_gdp2012)[7] <- "M2012"
colnames(oly_gdp2012)[13] <- "M2008"
oly_gdp2012[oly_gdp2012$Country=="HongKongChina", "Population"] <- 7155000
oly_gdp2012[is.na(oly_gdp2012$M2008), "M2008"] <- 0
oly_gdp2012 <- oly_gdp2012 %>%
mutate(Pop_std=scale(Population), GDP_std=scale(GDP))
oly12_lm <- glm(M2012~M2008+Pop_std+GDP_std, data=oly_gdp2012)
oly12_lm_est <- tidy(oly12_lm)$estimate
oly12_lm_est
library(GGally)
?ggpairs
?ggscatmat
glimpse(oly_gdp2012)
ggscatmat(oly12_gdp2012, columns=13:15)
ggscatmat(oly_gdp2012, columns=13:15)
ggscatmat(oly_gdp2012, columns=13:15) + scale_x_log10() + scale_y_log10()
vif(oly_lm)
vif(oly12_lm)
olympics2004 <- read_csv("../data/olympics2004.csv")
oly_gdp2012 <- merge(oly_gdp2012, olympics2004[,c("Country","Total")],
by="Country", all.x=TRUE)
glimpse(oly_gdp2012)
glimpse(olympics2004)
glimpse(oly_gdp2012)
?substr
olympics2004$Code <- substr(olympics2004$Country, 1, 3)
oly_gdp2012 <- merge(oly_gdp2012, olympics2004[,c("Country","Code","Total")],
by="Code", all.x=TRUE)
glimpse(oly_gdp2012)
olympics2008 <- read_csv("../data/olympics2008.csv")
olympics2012 <- read_csv("../data/olympics2012.csv")
gdp2008 <- read_delim("../data/gdp2008.csv", delim="\t",
col_names=FALSE)[,3:4]
colnames(gdp2008) <- c("Country", "GDP")
oly_gdp2008 <- merge(olympics2008, gdp2008, by="Country", all.x=TRUE)
gdp2012 <- read_delim("../data/gdp2012.csv", delim="\t",
col_names=FALSE)[,1:2]
colnames(gdp2012) <- c("Country", "GDP")
oly_gdp2012 <- merge(olympics2012, gdp2012, by="Country", all.x=TRUE)
oly_gdp2012 <- merge(oly_gdp2012, olympics2008[,c("Country","Total")],
by="Country", all.x=TRUE)
colnames(oly_gdp2012)[7] <- "M2012"
colnames(oly_gdp2012)[13] <- "M2008"
oly_gdp2012[oly_gdp2012$Country=="HongKongChina", "Population"] <- 7155000
oly_gdp2012[is.na(oly_gdp2012$M2008), "M2008"] <- 0
oly_gdp2012 <- oly_gdp2012 %>%
mutate(Pop_std=scale(Population), GDP_std=scale(GDP))
olympics2004 <- read_csv("../data/olympics2004.csv")
olympics2004$Code <- substr(olympics2004$Country, 1, 3)
oly_gdp2012 <- merge(oly_gdp2012, olympics2004[,c("Country","Code","Total")],
by="Code", all.x=TRUE)
glimpse(oly_gdp2012)
colnames(oly_gdp2012)[17] <- "M2004"
ggplot(oly_gdp2012, aes(x=M2004, y=M2008)) + geom_point()
oly12_lm <- glm(M2012~M2008+M2004+Pop_std+GDP_std, data=oly_gdp2012)
oly12_lm_est <- tidy(oly12_lm)$estimate
tidy(oly12_lm)
