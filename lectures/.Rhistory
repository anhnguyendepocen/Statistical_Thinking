ggplot(df, aes(x=x, y=d)) +
geom_line() + xlab("") + ylab("") +
ggtitle("Theory")
df2 <- data.frame(r=rpareto(1000, 1))
gplot(df2, aes(x=r)) + geom_bar() +
xlab("") + ylab("") + ggtitle("Sample")
gplot(df2, aes(x=r)) + geom_bar() +
xlab("") + ylab("") + ggtitle("Sample")
ggplot(df2, aes(x=r)) + geom_bar() +
xlab("") + ylab("") + ggtitle("Sample")
head(df2)
summary(df2)
ggplot(df2, aes(x=r)) + geom_histogram(binwidth=1) +
xlab("") + ylab("") + ggtitle("Sample")
ggplot(df2, aes(x=r)) + geom_histogram(binwidth=1) +
xlab("") + ylab("") + xlim(c(1,5)) + ggtitle("Sample")
2.5/1000
length(seq(0, 2.5, 0.0025))
length(seq(0.0025, 2.5, 0.0025))
?rweibull
df <- data.frame(x=seq(0.0025, 2.5, 0.0025),  r=rweibull(1000, shape=1.5), d=dweibull(seq(0.0025, 2.5, 0.0025), shape=1.5))
p1 <- ggplot(df, aes(x=x, y=d)) + geom_line() + xlab("") + ylab("") +
geom_hline(yintercept=0, colour="grey70") + ggtitle("Theory")
p2 <- ggplot(df, aes(x=r, y=..density..)) + geom_histogram(binwidth=0.5) + xlab("") + ylab("") + geom_line(aes(x=x, y=d), color="red") + ggtitle("Sample")
grid.arrange(p1, p2, ncol=2)
?rgamma
5/1000
lentgh(seq(0.005, 5, 0.005))
length(seq(0.005, 5, 0.005))
pgamma(2, upper.tail=TRUE)
?pgamma
pgamma(3.2, 2, lower.tail=FALSE)
pgamma(2.5, 2) - pgamma(1.5, 2)
100000/20
1000000/50
1000000/100
rs <- runif(1000000)
x2 <- apply(matrix(rs, ncol=2), 1, mean)
x20 <- apply(matrix(rs, ncol=20), 1, mean)
x50 <- apply(matrix(rs, ncol=50), 1, mean)
x100 <- apply(matrix(rs, ncol=100), 1, mean)
df <- data.frame(pop=rs[1:1000], x2=x2[1:1000], x20=x20[1:1000],
x50=x50[1:1000], x100=x100[1:1000])
head(df)
ggplot(data.frame(rs), aes(x=rs)) + geom_histogram(breaks=seq(0,1,0.1)) +
ggtitle("POPULATION") + xlab("")
qnorm(seq(0,1,1/12))
qnorm(seq(0,1,1/11))
qnorm(seq(1/12,1,1/12))
qgamma(seq(1/23,1,1/12), 2)
qgamma(seq(1/23,1,1/23), 2)
qgamma(0.78, 2)
```
qnorm(0.15)
qnorm(0.17)
st <- readRDS("../student_sub.rds")
st <- readRDS("student_sub.rds")
getwd()
st <- readRDS("../data/student_sub.rds")
glimpse(st)
aus <- st %>% filter(CNT == "AUS")
aus_math <- data.frame(PV1MATH = aus$PV1MATH, q=qnorm(seq(1/14481, 1, 1/14481)))
ggplot(aus_math, aes(x=PV1MATH, y=q)) + geom_point()
aus_math <- data.frame(PV1MATH = sort(aus$PV1MATH),
q=qnorm(seq(1/14481, 1, 1/14481)))
ggplot(aus_math, aes(x=PV1MATH, y=q)) + geom_point()
ggplot(aus_math, aes(x=PV1MATH, y=q)) + geom_point() + theme(aspect.ratio=1)
aus_math <- data.frame(PV1MATH = sort(scale(aus$PV1MATH)),
q=qnorm(seq(1/14481, 1, 1/14481)))
ggplot(aus_math, aes(x=PV1MATH, y=q)) + geom_point() + theme(aspect.ratio=1)
ggplot(aus_math, aes(x=PV1MATH, y=q)) + geom_point() +
xlab("Sample quantiles") + ylab("Theoretical quantile") +
theme(aspect.ratio=1)
ggplot(aus_math, aes(x=PV1MATH, y=q)) +
geom_abline(intercept=0, slope=1) +
geom_point() +
xlab("Sample quantiles") + ylab("Theoretical quantile") +
theme(aspect.ratio=1)
ggplot(aus_math, aes(x=PV1MATH, y=q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + xlim(c(-4.5, 4.5)) + ylim(c(-4.5, 4.5)) +
xlab("Sample quantiles") + ylab("Theoretical quantile") +
theme(aspect.ratio=1)
aus_math <- data.frame(PV1MATH = sort(scale(aus$PV1MATH)),
q=qnorm(c(1 - 0.5^(1/n), (2:(n-1) - 0.3175) / (n + 0.365),0.5^(1/n))))
ggplot(aus_math, aes(x=PV1MATH, y=q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + xlim(c(-5.5, 5.5)) + ylim(c(-5.5, 5.5)) +
xlab("Sample quantiles") + ylab("Theoretical quantile") +
theme(aspect.ratio=1)
n <- nrow(aus)
aus_math <- data.frame(PV1MATH = sort(scale(aus$PV1MATH)),
q=qnorm(c(1 - 0.5^(1/n), (2:(n-1) - 0.3175) / (n + 0.365),0.5^(1/n))))
ggplot(aus_math, aes(x=PV1MATH, y=q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + xlim(c(-5.5, 5.5)) + ylim(c(-5.5, 5.5)) +
xlab("Sample quantiles") + ylab("Theoretical quantile") +
theme(aspect.ratio=1)
rpareto <- function(n, c){
if (c<=0) stop("c must be positive")
rp <- runif(n)^(-1/c)
rp
}
df <- data.frame(re=scale(rexp(1000)), rp=scale(rpareto(1000, 1)))
p1 <- ggplot(df, aes(x=re)) + geom_histogram() + ggtitle("Exp")
p2 <- ggplot(df, aes(x=rp)) + geom_histogram() + ggtitle("Pareto")
p3 <- ggplot(df2, aes(x=re, y=rp)) +
geom_abline(intercept=0, slope=1) +
geom_point() +
xlab("exp") + ylab("Pareto") + ggtitle("QQ-plot")
grid.arrange(p1, p2, p3, ncol=3)
p3
library(emdbook)
install.packages("emdbook")
library(emdbook)
library("bbmle")
￼mtmp <- function(prob,size,theta) { -sum(dbetabinom(x1,prob,size,theta,log=TRUE))
}
￼mtmp <- function(prob,size,theta) -sum(dbetabinom(x1,prob,size,theta,log=TRUE))
}
mtmp <- function(prob,size,theta) {
-sum(dbetabinom(x1,prob,size,theta,log=TRUE))
}
(m0 <- mle2(mtmp,start=list(prob=0.2,theta=9),data=list(size=50)))
read_csv("../data/olympics2012.csv")
olympics2012 <- read_csv("../data/olympics2012.csv")
glimpse(olympics2012)
ggplot(olympics2012, aes(x=Total)) + geom_histogram()
nmle <- function(mu) {
f <- 1/(2*pi) exp{-(1-mu)^2+(3-mu)^2/2}
return(f)
}
nmle <- function(mu) {
f <- 1/(2*pi) exp(-((1-mu)^2+(3-mu)^2)/2)
return(f)
}
nmle <- function(mu) {
f <- 1/(2*pi) exp(-((1-mu)^2+(3-mu)^2)/2)
return(f)
}
nmle <- function(mu) {
f <- 1/(2*pi) exp(-((1-mu)^2+(3-mu)^2)/2)
nmle <- function(mu) {
f <- 1/(2*pi) e^(-((1-mu)^2+(3-mu)^2)/2)
return(f)
}
?e
?exp
nmle <- function(mu) {
f <- 1/(2*pi) * exp(-((1-mu)^2+(3-mu)^2)/2)
return(f)
}
nlme(2)
nmle(2)
df <- data.frame(x=seq(1, 3, 0.1), f=nmle(seq(1, 3, 0.1)))
ggplot(df, aes(x=x, y=f)) + geom_line()
x <- rnorm(10, 3, 4)
x
print(x)
?dnorm
?`summary,mle2-method`
?"sum"
?prod
?expand.grid
mu <- seq(1, 5, 0.5)
sig <- seq(2, 7, 0.5)
grid <- expand.grid(x=mu, y=sig)
grid
df <- data.frame(mu=grid$x, sig=grid$y, f=nmle(x, grid$x, grid$y))
nmle <- function(x, mu, sigma) {
f <- dnorm(x, mu, sigma)
return(prod(f))
}
df <- data.frame(mu=grid$x, sig=grid$y, f=nmle(x, grid$x, grid$y))
df
x
nmle <- function(x, mu, sigma) {
f <- dnorm(x, mu, sigma)
return(f)
}
df <- data.frame(mu=grid$x, sig=grid$y, f=nmle(x, grid$x, grid$y))
df
grid$f <- 0
for (i in 1:length(df)) {
grid$f[i] <- nmle(x, df$x[i], df$y[i])
}
grid <- expand.grid(x=mu, y=sig)
grid$f <- 0
for (i in 1:length(df)) {
grid$f[i] <- nmle(x, df$x[i], df$y[i])
}
x
i=1
nmle(x, df$x[i], df$y[i])
df$x[i]
nmle(x, grid$x[i], grid$y[i])
nmle <- function(x, mu, sigma) {
f <- dnorm(x, mu, sigma)
return(prod(f))
}
nmle(x, grid$x[i], grid$y[i])
grid$f <- 0
for (i in 1:length(df)) {
grid$f[i] <- nmle(x, grid$x[i], grid$y[i])
}
grid
?dnorm
nmle(x, 2.5, 2)
grid$f <- 0
for (i in 1:nrow(df)) {
grid$f[i] <- nmle(x, grid$x[i], grid$y[i])
}
grid
ggplot(grid, aes(x=x, y=y, fill=f)) + geom_tile() + xlab(expression(mu)) + ylab(expression(sigma))
x <- rnorm(20, 2, 3)
x
nmle <- function(x, mu, sigma) {
f <- dnorm(x, mu, sigma)
return(prod(f))
}
mu <- seq(1, 5, 0.1)
sig <- seq(2, 7, 0.1)
grid <- expand.grid(x=mu, y=sig)
grid$f <- 0
for (i in 1:nrow(df)) {
grid$f[i] <- nmle(x, grid$x[i], grid$y[i])
}
ggplot(grid, aes(x=x, y=y, fill=f)) + geom_tile() + xlab(expression(mu)) + ylab(expression(sigma)) + theme_bw() +
scale_fill_continuous("L") +
theme(aspect.ratio=1)
mu <- seq(1, 5, 0.1)
sig <- seq(2, 7, 0.1)
grid <- expand.grid(x=mu, y=sig)
grid$f <- 0
for (i in 1:nrow(df)) {
grid$f[i] <- nmle(x, grid$x[i], grid$y[i])
}
ggplot(grid, aes(x=x, y=y, fill=f)) + geom_tile() + xlab(expression(mu)) + ylab(expression(sigma)) + theme_bw() +
scale_fill_continuous("L") +
theme(aspect.ratio=1)
x <- rnorm(20, 4, 3)
x
nmle <- function(x, mu, sigma) {
f <- dnorm(x, mu, sigma)
return(prod(f))
}
mu <- seq(1, 5, 0.1)
sig <- seq(2, 7, 0.1)
grid <- expand.grid(x=mu, y=sig)
grid
grid$f <- 0
for (i in 1:nrow(df)) {
grid$f[i] <- nmle(x, grid$x[i], grid$y[i])
}
ggplot(grid, aes(x=x, y=y, fill=f)) + geom_tile() + xlab(expression(mu)) + ylab(expression(sigma)) + theme_bw() +
scale_fill_continuous("L") +
theme(aspect.ratio=1)
x <- rnorm(20, 3, 5)
x <- rnorm(10, 3, 5)
nmle <- function(x, mu, sigma) {
f <- dnorm(x, mu, sigma)
return(prod(f))
}
mu <- seq(1, 5, 0.1)
sig <- seq(2, 7, 0.1)
grid <- expand.grid(x=mu, y=sig)
grid$f <- 0
for (i in 1:nrow(df)) {
grid$f[i] <- nmle(x, grid$x[i], grid$y[i])
}
ggplot(grid, aes(x=x, y=y, fill=f)) + geom_tile() + xlab(expression(mu)) + ylab(expression(sigma)) + theme_bw() +
scale_fill_continuous("L") +
theme(aspect.ratio=1)
x <- rnorm(5, 3, 5)
x
mu <- seq(1, 5, 0.1)
sig <- seq(2, 7, 0.1)
grid <- expand.grid(x=mu, y=sig)
grid$f <- 0
for (i in 1:nrow(df)) {
grid$f[i] <- nmle(x, grid$x[i], grid$y[i])
}
ggplot(grid, aes(x=x, y=y, fill=f)) + geom_tile() + xlab(expression(mu)) + ylab(expression(sigma)) + theme_bw() +
scale_fill_continuous("L") +
theme(aspect.ratio=1)
x
mu <- seq(1, 5, 0.5)
sig <- seq(2, 7, 0.5)
grid <- expand.grid(x=mu, y=sig)
grid$f <- 0
for (i in 1:nrow(df)) {
grid$f[i] <- nmle(x, grid$x[i], grid$y[i])
}
ggplot(grid, aes(x=x, y=y, fill=f)) + geom_tile() + xlab(expression(mu)) + ylab(expression(sigma)) + theme_bw() +
scale_fill_continuous("L") +
theme(aspect.ratio=1)
mu <- seq(1, 5, 0.5)
sig <- seq(2, 7, 0.5)
grid <- expand.grid(x=mu, y=sig)
grid$f <- 0
for (i in 1:nrow(df)) {
grid$f[i] <- nmle(x, grid$x[i], grid$y[i])
}
ggplot(grid, aes(x=x, y=y, fill=f)) + geom_tile() + xlab(expression(mu)) + ylab(expression(sigma)) + theme_bw() +
scale_fill_continuous("L") +
theme(aspect.ratio=1)
x <- rnorm(5, 3, 5)
mu <- seq(1, 5, 0.5)
sig <- seq(2, 7, 0.5)
grid <- expand.grid(x=mu, y=sig)
grid$f <- 0
for (i in 1:nrow(df)) {
grid$f[i] <- nmle(x, grid$x[i], grid$y[i])
}
ggplot(grid, aes(x=x, y=y, fill=f)) + geom_tile() + xlab(expression(mu)) + ylab(expression(sigma)) + theme_bw() +
scale_fill_continuous("L") +
theme(aspect.ratio=1)
mu <- seq(1, 5, 0.5)
sig <- seq(2, 7, 0.5)
grid <- expand.grid(x=mu, y=sig)
grid$f <- 0
for (i in 1:nrow(df)) {
grid$f[i] <- nmle(x, grid$x[i], grid$y[i])
}
ggplot(grid, aes(x=x, y=y, fill=f)) + geom_tile() + xlab(expression(mu)) + ylab(expression(sigma)) + theme_bw() +
scale_fill_continuous("L") +
theme(aspect.ratio=1)
x <- rnorm(5, 3, 5)
mu <- seq(1, 5, 0.5)
sig <- seq(2, 7, 0.5)
grid <- expand.grid(x=mu, y=sig)
grid$f <- 0
for (i in 1:nrow(df)) {
grid$f[i] <- nmle(x, grid$x[i], grid$y[i])
}
ggplot(grid, aes(x=x, y=y, fill=f)) + geom_tile() + xlab(expression(mu)) + ylab(expression(sigma)) + theme_bw() +
scale_fill_continuous("L") +
theme(aspect.ratio=1)
x <- rnorm(5, 3, 5)
mu <- seq(1, 5, 0.5)
sig <- seq(2, 7, 0.5)
grid <- expand.grid(x=mu, y=sig)
grid$f <- 0
for (i in 1:nrow(df)) {
grid$f[i] <- nmle(x, grid$x[i], grid$y[i])
}
ggplot(grid, aes(x=x, y=y, fill=f)) + geom_tile() + xlab(expression(mu)) + ylab(expression(sigma)) + theme_bw() +
scale_fill_continuous("L") +
theme(aspect.ratio=1)
x <- rnorm(5, 3, 5)
mu <- seq(1, 5, 0.5)
sig <- seq(2, 7, 0.5)
grid <- expand.grid(x=mu, y=sig)
grid$f <- 0
for (i in 1:nrow(df)) {
grid$f[i] <- nmle(x, grid$x[i], grid$y[i])
}
ggplot(grid, aes(x=x, y=y, fill=f)) + geom_tile() + xlab(expression(mu)) + ylab(expression(sigma)) + theme_bw() +
scale_fill_continuous("L") +
theme(aspect.ratio=1)
set.seed(2016)
x <- rnorm(5, 3, 5)
x
mu <- seq(1, 5, 0.5)
sig <- seq(2, 7, 0.5)
grid <- expand.grid(x=mu, y=sig)
grid$f <- 0
for (i in 1:nrow(df)) {
grid$f[i] <- nmle(x, grid$x[i], grid$y[i])
}
ggplot(grid, aes(x=x, y=y, fill=f)) + geom_tile() + xlab(expression(mu)) + ylab(expression(sigma)) + theme_bw() +
scale_fill_continuous("L") +
theme(aspect.ratio=1)
set.seed(567)
x <- rnorm(5, 3, 5)
x
mu <- seq(1, 5, 0.5)
sig <- seq(2, 7, 0.5)
grid <- expand.grid(x=mu, y=sig)
grid$f <- 0
for (i in 1:nrow(df)) {
grid$f[i] <- nmle(x, grid$x[i], grid$y[i])
}
ggplot(grid, aes(x=x, y=y, fill=f)) + geom_tile() + xlab(expression(mu)) + ylab(expression(sigma)) + theme_bw() +
scale_fill_continuous("L") +
theme(aspect.ratio=1)
set.seed(567)
x <- rnorm(5, 3, 5)
x
nmle <- function(x, mu, sigma) {
f <- prod(dnorm(x, mu, sigma))
return(f)
}
mu <- seq(1, 5, 0.5)
sig <- seq(2, 7, 0.5)
g <- expand.grid(x=mu, y=sig)
g$f <- 0
for (i in 1:nrow(df)) {
g$f[i] <- nmle(x, g$x[i], g$y[i])
}
dim(g)
summary(g)
ggplot(g, aes(x=x, y=y, fill=f)) + geom_tile() + xlab(expression(mu)) + ylab(expression(sigma)) + theme_bw() +
scale_fill_continuous("L") +
theme(aspect.ratio=1)
10^(10^(10^(10^(10^10))))
library(ggplot2)
library(dplyr)
df <- data.frame(x=seq(-14, 18, 0.2), y=dnorm(seq(-14, 18, 0.2), 2, 4))
ar <- df %>% filter(x<1)
ar <- rbind(ar, c(1,0))
ggplot(data=df, aes(x=x, y=y)) + geom_line() +
geom_polygon(ar, fill="red")
ggplot(data=df, aes(x=x, y=y)) + geom_line() +
geom_polygon(ar, aes(x=x, y=y), fill="red")
head(ar)
tail(ar)
ar <- df %>% filter(x<=1)
ggplot(data=df, aes(x=x, y=y)) + geom_line() +
geom_polygon(ar, aes(x=x, y=y), fill="red")
is.data.frame(ar)
ar <- df %>% filter(x<=1)
ar <- rbind(c(-14, 0), ar, c(1,0))
ggplot(data=df, aes(x=x, y=y)) + geom_line()
ggplot(data=df, aes(x=x, y=y)) + geom_line() +
geom_polygon(data=ar, aes(x=x, y=y), fill="red")
ggplot(data=df, aes(x=x, y=y)) + geom_line() +
geom_polygon(data=ar, aes(x=x, y=y), fill="red") +
geom_vline(xintercept=1, colour="red") +
geom_text(aes(x=1, y=-0.001, label="X")) +
xlab("") + ylab("density")
ggplot(data=df, aes(x=x, y=y)) + geom_line() +
geom_polygon(data=ar, aes(x=x, y=y), fill="red") +
geom_vline(xintercept=1, colour="red") +
geom_text(aes(x=1, y=-0.002, label="X"), colour="red") +
xlab("") + ylab("density")
geom_text(aes(x=1, y=-0.005, label="X"), colour="red") +
ggplot(data=df, aes(x=x, y=y)) + geom_line() +
geom_polygon(data=ar, aes(x=x, y=y), fill="red") +
geom_vline(xintercept=1, colour="red") +
geom_text(aes(x=1, y=-0.005, label="X"), colour="red") +
xlab("") + ylab("density")
?geom_text
ggplot(data=df, aes(x=x, y=y)) + geom_line() +
geom_polygon(data=ar, aes(x=x, y=y), fill="red") +
geom_vline(xintercept=1, colour="red") +
geom_text(aes(x=1, y=-0.003, label="X"), colour="red", nudge_x = 0.05) +
xlab("") + ylab("density")
library(ggplot2)
library(dplyr)
df <- data.frame(x=seq(-14, 18, 0.2), y=dnorm(seq(-14, 18, 0.2), 2, 4))
ar <- df %>% filter(x<=1)
ar <- rbind(c(-14, 0), ar, c(1,0))
ggplot(data=df, aes(x=x, y=y)) + geom_line() +
geom_polygon(data=ar, aes(x=x, y=y), fill="red") +
geom_vline(xintercept=1, colour="red") +
geom_text(aes(x=1, y=-0.003, label="X"), colour="red", nudge_x = 1) +
xlab("") + ylab("density")
ggplot(data=df, aes(x=x, y=y)) + geom_line() +
geom_polygon(data=ar, aes(x=x, y=y), fill="red") +
geom_vline(xintercept=1, colour="red") +
geom_text(aes(x=1, y=-0.003, label="X"), colour="red", nudge_x = -1) +
xlab("") + ylab("density")
ggplot(data=df, aes(x=x, y=y)) + geom_line() +
geom_polygon(data=ar, aes(x=x, y=y), fill="red") +
geom_vline(xintercept=1, colour="orange") +
geom_text(aes(x=1, y=-0.003, label="X"), colour="orange", nudge_x = -0.8) +
geom_text(aes(x=-5, y=0.05, label="Y"), colour="red") +
geom_segment(aes(x=-0.5, xend=-1, y=0.025, yend=0.05), colour="red") +
xlab("") + ylab("density")
ggplot(data=df, aes(x=x, y=y)) + geom_line() +
geom_polygon(data=ar, aes(x=x, y=y), fill="red") +
geom_vline(xintercept=1, colour="orange") +
geom_text(aes(x=1, y=-0.003, label="X"), colour="orange", nudge_x = -0.8) +
geom_text(aes(x=-5, y=0.05, label="Y"), colour="red") +
geom_segment(aes(x=-0.5, xend=-1, y=0.025, yend=0.05), colour="red") +
xlab("") + ylab("density") + theme_bw()
ggplot(data=df, aes(x=x, y=y)) + geom_line() +
geom_polygon(data=ar, aes(x=x, y=y), fill="red") +
geom_vline(xintercept=1, colour="orange") +
geom_text(aes(x=1, y=-0.003, label="X"), colour="orange", nudge_x = -0.8) +
geom_text(aes(x=-5, y=0.05, label="Y"), colour="red") +
geom_segment(aes(x=-0.5, xend=-5, y=0.025, yend=0.05), colour="red") +
xlab("") + ylab("density") + theme_bw()
ggplot(data=df, aes(x=x, y=y)) + geom_line() +
geom_polygon(data=ar, aes(x=x, y=y), fill="red") +
geom_vline(xintercept=1, colour="orange") +
geom_text(aes(x=1, y=-0.003, label="X"), colour="orange", nudge_x = -0.8) +
geom_text(aes(x=-5, y=0.05, label="Y"), colour="red") +
geom_segment(aes(x=-0.5, xend=-5, y=0.025, yend=0.04), colour="red") +
xlab("") + ylab("density") + theme_bw()
ggplot(data=df, aes(x=x, y=y)) + geom_line() +
geom_polygon(data=ar, aes(x=x, y=y), fill="red") +
geom_vline(xintercept=1, colour="orange") +
geom_text(aes(x=1, y=-0.003, label="X"), colour="orange", nudge_x = -0.8) +
geom_text(aes(x=-5, y=0.05, label="Y"), colour="red") +
geom_segment(aes(x=-0.5, xend=-4.8, y=0.025, yend=0.048), colour="red") +
xlab("") + ylab("density") + theme_bw()
ggplot(data=df, aes(x=x, y=y)) + geom_line() +
geom_polygon(data=ar, aes(x=x, y=y), fill="red") +
geom_vline(xintercept=1, colour="black") +
geom_text(aes(x=1, y=-0.003, label="X"), colour="black", nudge_x = -0.8) +
geom_text(aes(x=-5, y=0.05, label="Y"), colour="black") +
geom_segment(aes(x=-0.5, xend=-4.8, y=0.025, yend=0.048), colour="black") +
xlab("") + ylab("density") + theme_bw()
ggplot(data=df, aes(x=x, y=y)) + geom_line() +
geom_polygon(data=ar, aes(x=x, y=y), fill="grey80") +
geom_vline(xintercept=1, colour="black") +
geom_text(aes(x=1, y=-0.003, label="X"), colour="black", nudge_x = -0.8) +
geom_text(aes(x=-5, y=0.05, label="Y"), colour="black") +
geom_segment(aes(x=-0.5, xend=-4.8, y=0.025, yend=0.048), colour="black") +
xlab("") + ylab("density") + theme_bw()
